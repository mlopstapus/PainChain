{
  "id": "gitlab",
  "displayName": "GitLab",
  "color": "#fc6d26",
  "logo": "gitlab.png",
  "description": "Track merge requests, releases, pipeline runs, and commits from GitLab projects",
  "webhookSupport": {
    "enabled": true,
    "url": "https://your-painchain-domain.com/api/webhooks/gitlab/{connectionId}",
    "instructions": [
      "1. Go to your GitLab project settings",
      "2. Navigate to Settings > Webhooks",
      "3. Set URL to the webhook URL above (replace {connectionId} with your connection ID)",
      "4. Set Secret Token to your connection's webhook secret",
      "5. Select trigger events: Push events, Merge request events, Pipeline events, Releases events",
      "6. Ensure 'Enable SSL verification' is checked",
      "7. Click 'Add webhook'"
    ]
  },
  "connectionForm": {
    "fields": [
      {
        "key": "name",
        "label": "Connection Name",
        "type": "text",
        "placeholder": "e.g., Company GitLab, Personal Projects",
        "required": true
      },
      {
        "key": "token",
        "label": "Token",
        "type": "password",
        "placeholder": "Enter GitLab Personal Access Token",
        "help": "Used for API access and manual sync. Required even when using webhooks.",
        "required": true
      },
      {
        "key": "webhookSecret",
        "label": "Webhook Secret",
        "type": "password",
        "placeholder": "Generate random string (e.g., openssl rand -hex 32)",
        "help": "Secret token used to verify webhook authenticity. Use when configuring webhook in GitLab. Leave empty to skip webhook setup and use manual sync only.",
        "required": false
      },
      {
        "key": "repos",
        "label": "Project IDs",
        "type": "text",
        "placeholder": "76910432,12345678",
        "help": "Comma-separated numeric project IDs (recommended) or project paths (group/project). Leave empty for all projects. Find Project ID in GitLab project settings.",
        "required": false
      },
      {
        "key": "branches",
        "label": "Branches",
        "type": "text",
        "placeholder": "main,develop,staging",
        "help": "Comma-separated branch names to track commits from.",
        "required": false
      },
      {
        "key": "tags",
        "label": "Tags",
        "type": "text",
        "placeholder": "tag1,tag2,tag3",
        "help": "Comma-separated tags for filtering events by team.",
        "required": false
      }
    ]
  },
  "eventTypes": {
    "MR": {
      "displayName": "Merge Requests (GitLab)",
      "fields": {
        "branches": { "defaultVisibility": true, "fieldLabel": "Branch Information" },
        "approved_by": { "defaultVisibility": true, "fieldLabel": "Approved By" },
        "approvals": { "defaultVisibility": true, "fieldLabel": "Approval Count" },
        "comments": { "defaultVisibility": true, "fieldLabel": "Comments Count" },
        "votes": { "defaultVisibility": true, "fieldLabel": "Votes (Up/Down)" },
        "merged": { "defaultVisibility": true, "fieldLabel": "Merge Status" },
        "files_changed": { "defaultVisibility": true, "fieldLabel": "Files Changed List" }
      }
    },
    "Pipeline": {
      "displayName": "Pipelines (GitLab CI)",
      "fields": {
        "status": { "defaultVisibility": true, "fieldLabel": "Status" },
        "duration": { "defaultVisibility": true, "fieldLabel": "Duration" },
        "ref": { "defaultVisibility": true, "fieldLabel": "Reference" },
        "commit": { "defaultVisibility": true, "fieldLabel": "Commit SHA" },
        "source": { "defaultVisibility": true, "fieldLabel": "Source" },
        "pipeline_id": { "defaultVisibility": true, "fieldLabel": "Pipeline ID" },
        "failed_jobs": { "defaultVisibility": true, "fieldLabel": "Failed Jobs Count" },
        "failed_jobs_detail": { "defaultVisibility": true, "fieldLabel": "Failed Jobs Details" },
        "logs": { "defaultVisibility": true, "fieldLabel": "View Logs Link" }
      }
    },
    "Commit": {
      "displayName": "Commits",
      "fields": {
        "branch": { "defaultVisibility": true, "fieldLabel": "Branch" },
        "sha": { "defaultVisibility": true, "fieldLabel": "Commit SHA" },
        "changes": { "defaultVisibility": true, "fieldLabel": "Code Changes" },
        "files_changed": { "defaultVisibility": true, "fieldLabel": "Files Changed List" }
      }
    },
    "Release": {
      "displayName": "Releases",
      "fields": {
        "tag": { "defaultVisibility": true, "fieldLabel": "Tag Name" },
        "prerelease": { "defaultVisibility": true, "fieldLabel": "Pre-release Flag" },
        "draft": { "defaultVisibility": true, "fieldLabel": "Draft Flag" },
        "assets": { "defaultVisibility": true, "fieldLabel": "Release Assets" }
      }
    },
    "Image": {
      "displayName": "Container Images (Registry)",
      "fields": {
        "registry": { "defaultVisibility": true, "fieldLabel": "Registry" },
        "image": { "defaultVisibility": true, "fieldLabel": "Image Path" },
        "size": { "defaultVisibility": true, "fieldLabel": "Image Size" },
        "digest": { "defaultVisibility": true, "fieldLabel": "Digest (SHA)" },
        "package": { "defaultVisibility": true, "fieldLabel": "Package Name" },
        "repository": { "defaultVisibility": true, "fieldLabel": "Repository" },
        "tags": { "defaultVisibility": true, "fieldLabel": "Image Tags" }
      }
    }
  }
}
